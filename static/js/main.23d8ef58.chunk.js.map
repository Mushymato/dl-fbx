{"version":3,"sources":["Viewer.js","Model.js","Gallery.js","App.js","serviceWorker.js","index.js"],"names":["OrbitControls","require","THREE","FBXLoader","skeleClone","source","sourceLookup","Map","cloneLookup","clone","parallelTraverse","a","b","callback","i","children","length","sourceNode","clonedNode","set","traverse","node","isSkinnedMesh","clonedMesh","sourceMesh","get","sourceBones","skeleton","bones","bindMatrix","copy","map","bone","bind","ReactThreeVisor","checkProps","cameraPosition","props","x","y","z","controlsPosition","viewport","width","window","innerWidth","height","innerHeight","angle","far","near","lights","ligths","zoom","animate","animation","requestAnimationFrame","mixers","d","clock","getDelta","update","renderer","render","scene","camera","init","position","updateProjectionMatrix","controls","target","fog","light","add","castShadow","shadow","top","bottom","left","right","matcap","fbxSource","loaderCallback","object","textureFile","richFile","offset","material","txLoader","texture","load","skinning","wireframe","Boolean","applyMaterial","materials","newMaterial","Array","isArray","faceOffset","child","name","includes","visible","isMesh","m","geometry","groups","faceGroups","filter","k","count","start","Math","min","end","max","attributes","uv","array","rotation","addAnimation","mixer","push","undefined","animationIdx","args","split","aniFile","aniName","ani","obj","animations","find","clipAction","play","outRatio","outline","scale","multiplyScalar","c","outlineMaterial","color","side","receiveShadow","model","rich","s","handleLoad","error","handleError","antialias","alpha","setClearColor","pixelate","setPixelRatio","domElement","style","cssText","devicePixelRatio","setSize","shadowMap","enabled","container","appendChild","e","onLoad","onLoading","onError","this","cancelAnimationFrame","ref","el","React","Component","cameraPositions","w","h","o","r","c100034_01","h0010001","h0010001_02","h0040101","r0070401","r0080401","d210078_01","d210114_01","smith","controlsPositions","faceOffsets","face1","face2","face3","face4","face5","face6","face7","face8","face9","textureOverride","r0060401","o0090401","Model","state","asset","handleChange","parts","match","params","setState","texture_asset","substring","updateModelState","prevProps","location","value","Fragment","type","order","rot","parseFloat","ctrl","cam","face","renderMode","rm","ratio","parseInt","isNaN","backgroundColor","withRouter","CharacterIndex","faces","Object","keys","fbxIdx","fn","nwt","win","float","minWidth","minHeight","margin","key","to","fi","DragonIndex","WeaponIndex","wt","ex","OtherIndex","other","textAlign","process","App","basename","exact","path","component","isLocalhost","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","ReactDOM","document","getElementById","URL","href","origin","addEventListener","fetch","response","contentType","headers","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"uq3CAKIA,EAAgBC,EAAQ,GAARA,CAAgCC,GAChDC,EAAYF,EAAQ,IAQxB,SAASG,EAAWC,GAClB,IAAIC,EAAe,IAAIC,IACnBC,EAAc,IAAID,IAClBE,EAAQJ,EAAOI,QAiBnB,OA1BF,SAASC,EAAiBC,EAAGC,EAAGC,GAC9BA,EAASF,EAAGC,GACZ,IAAK,IAAIE,EAAI,EAAGA,EAAIH,EAAEI,SAASC,OAAQF,IACrCJ,EAAiBC,EAAEI,SAASD,GAAIF,EAAEG,SAASD,GAAID,GAOjDH,CAAiBL,EAAQI,GAAO,SAAUQ,EAAYC,GACpDZ,EAAaa,IAAID,EAAYD,GAC7BT,EAAYW,IAAIF,EAAYC,MAE9BT,EAAMW,UAAS,SAAUC,GACvB,GAAKA,EAAKC,cAAV,CACA,IAAIC,EAAaF,EACbG,EAAalB,EAAamB,IAAIJ,GAC9BK,EAAcF,EAAWG,SAASC,MACtCL,EAAWI,SAAWH,EAAWG,SAASlB,QAC1Cc,EAAWM,WAAWC,KAAKN,EAAWK,YACtCN,EAAWI,SAASC,MAAQF,EAAYK,KAAI,SAAUC,GACpD,OAAOxB,EAAYiB,IAAIO,MAEzBT,EAAWU,KAAKV,EAAWI,SAAUJ,EAAWM,gBAE3CpB,E,IAGYyB,E,4MAgBnBC,WAAa,WACX,EAAKC,eAAiB,EAAKC,MAAMD,gBAAkB,CAAEE,EAAG,EAAGC,EAAG,EAAGC,EAAG,IACpE,EAAKC,iBAAmB,EAAKJ,MAAMI,kBAAoB,CAAEH,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACxE,EAAKE,SAAW,EAAKL,MAAMK,UAAY,CACrCC,MAAOC,OAAOC,WACdC,OAAQF,OAAOG,aAEjB,EAAKC,MAAQ,EAAKX,MAAMW,OAAS,GACjC,EAAKC,IAAM,EAAKZ,MAAMY,KAAO,IAC7B,EAAKC,KAAO,EAAKb,MAAMa,MAAQ,EAC/B,EAAKC,OAAS,EAAKd,MAAMe,QAAU,KACnC,EAAKC,KAAO,EAAKhB,MAAMgB,MAAQ,G,EASjCC,QAAU,WAER,GADA,EAAKC,UAAYC,sBAAsB,EAAKF,SACxC,EAAKG,OAAOzC,OAAS,EAEvB,IADA,IAAM0C,EAAI,EAAKC,MAAMC,WACZ9C,EAAI,EAAGA,EAAI,EAAK2C,OAAOzC,OAAQF,IACtC,EAAK2C,OAAO3C,GAAG+C,OAAOH,GAG1B,EAAKI,SAASC,OAAO,EAAKC,MAAO,EAAKC,S,EAExCC,KAAO,WAEL,EAAKT,OAAS,GACd,EAAKE,MAAQ,IAAIzD,QAGjB,EAAK+D,OAAS,IAAI/D,oBAChB,EAAK8C,MACL,EAAKN,SAASC,MAAQ,EAAKD,SAASI,OACpC,EAAKI,KACL,EAAKD,KAEP,EAAKgB,OAAOE,SAAShD,IACnB,EAAKiB,eAAeE,EACpB,EAAKF,eAAeG,EACpB,EAAKH,eAAeI,GAEtB,EAAKyB,OAAOZ,KAAO,EAAKA,KACxB,EAAKY,OAAOG,yBAGZ,EAAKC,SAAW,IAAIrE,EAAc,EAAKiE,QACvC,EAAKI,SAASC,OAAOnD,IACnB,EAAKsB,iBAAiBH,EACtB,EAAKG,iBAAiBF,EACtB,EAAKE,iBAAiBD,GAExB,EAAK6B,SAASR,SAGd,EAAKG,MAAQ,IAAI9D,QAGjB,EAAK8D,MAAMO,IAAM,IAAIrE,MAAU,SAAU,IAAK,KAG9C,IAAIsE,EAAQ,IAAItE,kBAAsB,SAAU,SAChDsE,EAAML,SAAShD,IAAI,EAAG,IAAK,GAC3B,EAAK6C,MAAMS,IAAID,IACfA,EAAQ,IAAItE,mBAAuB,WAC7BiE,SAAShD,IAAI,EAAG,IAAK,KAC3BqD,EAAME,YAAa,EACnBF,EAAMG,OAAOV,OAAOW,IAAM,IAC1BJ,EAAMG,OAAOV,OAAOY,QAAU,IAC9BL,EAAMG,OAAOV,OAAOa,MAAQ,IAC5BN,EAAMG,OAAOV,OAAOc,MAAQ,IAC5BP,EAAQ,IAAItE,mBAAuB,UACnC,EAAK8D,MAAMS,IAAID,GACfA,EAAQ,IAAItE,eAAmB,SAC/B,EAAK8D,MAAMS,IAAID,GACf,EAAKQ,OAAL,UAAiBC,EAAjB,6BAEA,IAAMC,EAAiB,SAACC,EAAQC,EAAaC,EAAUC,GACrD,IAAIC,EAAW,KACf,GAAoB,OAAhBH,EAAsB,CACxB,IAAMI,EAAW,IAAItF,gBACfuF,EAAUD,EAASE,KAAKN,GAExBJ,GADOQ,EAASE,KAAKL,GACZG,EAASE,KAAK,EAAKV,SAClCO,EAAW,IAAIrF,qBAAyB,CACtC6B,IAAK0D,EAELT,OAAQA,EACRW,UAAU,EACVC,UAAWC,QAAQ,EAAKxD,MAAMuD,aAGlC,IAAME,EAAgB,SAACC,EAAWC,GAChC,OAAIC,MAAMC,QAAQH,GACTA,EAAUhE,KAAI,WACnB,OAAOiE,KAGFA,GAwBLG,EAAa,EAAK9D,MAAM8D,WAC9BhB,EAAO/D,UAAS,SAAUgF,GAtBF,IAACL,EAoCvB,GAbIK,EAAMC,KAAKC,SAAS,SACtBF,EAAMG,SAAU,GAEdH,EAAMI,QAAyB,kBAAfJ,EAAMC,OAEtBD,EAAMb,SADS,OAAbA,EACeO,EAAcM,EAAMb,SAAUA,IA5B5BQ,EA8BcK,EAAMb,SA7BvCU,MAAMC,QAAQH,GACTA,EAAUhE,KAAI,SAAC0E,GACpB,OAAO,IAAIvG,qBAAyB,CAClC6B,IAAK0E,EAAE1E,IAEPiD,OAAQyB,EAAEzB,OACVW,UAAU,EACVC,UAAWC,QAAQ,EAAKxD,MAAMuD,gBAI3B,IAAI1F,qBAAyB,CAClC6B,IAAKgE,EAAUhE,IAGf4D,UAAU,EACVC,UAAWC,QAAQ,EAAKxD,MAAMuD,eAmBf,aAAfQ,EAAMC,MAUJF,GAA+C,IAAjCC,EAAMM,SAASC,OAAO3F,OAAc,CACpD,IAAM4F,EAAaR,EAAMM,SAASC,OAAOE,QAAO,SAAAC,GAC9C,OAAOA,EAAEC,MAAQ,OAEnB,GAA0B,IAAtBH,EAAW5F,OAGb,IAFA,IAAMgG,EAAQC,KAAKC,IAAIN,EAAW,GAAGI,MAAOJ,EAAW,GAAGI,OACpDG,EAAMF,KAAKG,IAAIR,EAAW,GAAGI,MAAQJ,EAAW,GAAGG,MAAOH,EAAW,GAAGI,MAAQJ,EAAW,GAAGG,OAC3FjG,EAAIkG,EAAOlG,EAAIqG,EAAKrG,GAAK,EAChCsF,EAAMM,SAASW,WAAWC,GAAGC,MAAU,EAAJzG,IAAU,IAAOqF,EAAW7D,EAC/D8D,EAAMM,SAASW,WAAWC,GAAGC,MAAU,EAAJzG,EAAQ,IAAM,IAAOqF,EAAW5D,MAOzE,EAAKF,MAAMmF,WACbrC,EAAOqC,SAASlF,EAAI,EAAKD,MAAMmF,SAASlF,EACxC6C,EAAOqC,SAASjF,EAAI,EAAKF,MAAMmF,SAASjF,EACxC4C,EAAOqC,SAAShF,EAAI,EAAKH,MAAMmF,SAAShF,GAE3B,OAAX8C,GACFH,EAAOhB,SAASM,IAAIa,GAGtB,IAAMmC,EAAe,SAACtC,GAKpB,GAJAA,EAAOuC,MAAQ,IAAIxH,iBAAqBiF,GACpCA,EAAOuC,OACT,EAAKjE,OAAOkE,KAAKxC,EAAOuC,YAEME,IAA5B,EAAKvF,MAAMwF,aACb,GAAI,EAAKxF,MAAMwF,aAAavB,SAAS,KAAM,CACzC,IAAMwB,EAAO,EAAKzF,MAAMwF,aAAaE,MAAM,KAC3C,GAAoB,IAAhBD,EAAK9G,OAAc,CACrB,IAAMgH,EAAUF,EAAK,GACfG,EAAUH,EAAK,GACfI,EAAG,UAAMjD,EAAN,gBAAuB+C,EAAvB,SACO,IAAI7H,GACVuF,KAAKwC,GAAK,SAAAC,GAClB,IAAM5E,EAAY4E,EAAIC,WAAWC,MAAK,SAAA1H,GAAC,OAAIA,EAAE0F,OAAS4B,KAClD1E,GACW4B,EAAOuC,MAAMY,WAAW/E,GAC9BgF,gBAIR,GAAIpD,EAAOiD,YAAcjD,EAAOiD,WAAW,EAAK/F,MAAMwF,cAAe,CAC7D1C,EAAOuC,MAAMY,WAAWnD,EAAOiD,WAAW,EAAK/F,MAAMwF,eAC3DU,SAIbd,EAAaxF,KAAb,gBACAwF,EAAatC,GAEb,IAAMqD,EAAW,EAAKnG,MAAMoG,QAC5B,GAAID,EAAW,EAAG,CAChB,IAAMC,EAAUrI,EAAW+E,GAC3BsD,EAAQtE,SAASM,IAAI,IAAIvE,UAAc,GAAIsI,EAAW,IAAK,IAC3DC,EAAQC,MAAMC,eAAe,EAAIH,GACjCC,EAAQrH,UAAS,SAAUwH,GACzB,GAAIA,EAAEpC,OAAQ,CACZ,IAAMqC,EAAkB,IAAI3I,oBAAwB,CAClD4I,MAAO,EACPnD,UAAU,EACVoD,KAAM7I,aAER0I,EAAErD,SAAWO,EAAc8C,EAAErD,SAAUsD,GACvCD,EAAElE,YAAa,EACfkE,EAAEI,eAAgB,MAGtBvB,EAAagB,GACb,EAAKzE,MAAMS,IAAIgE,GAEjB,EAAKzE,MAAMS,IAAIU,KAEjBD,EAAejD,KAAf,gBACI,EAAKI,MAAM4G,SACA,IAAI9I,GACVuF,KACL,EAAKrD,MAAM4G,OACX,SAAA9D,GACED,EAAeC,EAAQ,EAAK9C,MAAMoD,QAAS,EAAKpD,MAAM6G,KAAM,SAE9D,SAAAC,GACE,EAAKC,WAAWD,MAElB,SAAAE,GACE,EAAKC,YAAYD,MAyBvB,EAAKvF,SAAW,IAAI5D,gBAAoB,CAAEqJ,WAAW,EAAOC,OAAO,IACnE,EAAK1F,SAAS2F,cAAc,EAAU,GAElC,EAAKpH,MAAMqH,UACb,EAAK5F,SAAS6F,cAAc,EAAKtH,MAAMqH,UACvC,EAAK5F,SAAS8F,WAAWC,MAAMC,QAAU,0DAEzC,EAAKhG,SAAS6F,cAAc/G,OAAOmH,kBAGrC,EAAKjG,SAASkG,QAAQ,EAAKtH,SAASC,MAAO,EAAKD,SAASI,QAEzD,EAAKgB,SAASmG,UAAUC,SAAU,EAClC,EAAKC,UAAUC,YAAY,EAAKtG,SAAS8F,YAEzC,EAAKtG,W,EAGP8F,WAAa,SAAAiB,GACP,EAAKhI,MAAMiI,QACb,EAAKjI,MAAMkI,UAAUF,I,EAIzBf,YAAc,SAAAe,GACR,EAAKhI,MAAMmI,SACb,EAAKnI,MAAMmI,QAAQH,I,kEAKrBI,KAAKtI,aACLsI,KAAKvG,S,6CAILwG,qBAAqBD,KAAKlH,WAC1BkH,KAAKhH,OAAS,KACdgH,KAAK9G,MAAQ,KACb8G,KAAKxG,OAAS,KACdwG,KAAKpG,SAAW,KAChBoG,KAAKzG,MAAQ,KACbyG,KAAK3G,SAAW,O,+BAER,IAAD,OACP,OACE,yBACE6G,IAAK,SAAAC,GACH,EAAKT,UAAYS,S,GA1UkBC,IAAMC,WC7B7CC,EAAkB,CACtBnC,EAAG,CAAEtG,EAAG,EAAGC,EAAG,GAAKC,EAAG,KACtBkB,EAAG,CAAEpB,EAAG,EAAGC,EAAG,GAAKC,EAAG,GACtBwI,EAAG,CAAE1I,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACpB5B,EAAG,CAAE0B,EAAG,EAAGC,EAAG,GAAKC,EAAG,GACtB6H,EAAG,CAAE/H,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACpByI,EAAG,CAAE3I,EAAG,EAAGC,EAAG,GAAKC,EAAG,GACtB0I,EAAG,CAAE5I,EAAG,EAAGC,EAAG,GAAKC,EAAG,GACtB2I,EAAG,CAAE7I,EAAG,EAAGC,EAAG,EAAGC,EAAG,IAEpB4I,WAAY,CAAE9I,EAAG,EAAGC,EAAG,GAAKC,EAAG,MAC/B6I,SAAU,CAAE/I,EAAG,EAAGC,EAAG,GAAKC,EAAG,GAC7B8I,YAAa,CAAEhJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAC9B+I,SAAU,CAAEjJ,EAAG,EAAGC,EAAG,GAAKC,EAAG,GAC7BgJ,SAAU,CAAElJ,EAAG,GAAIC,EAAG,GAAIC,EAAG,KAC7BiJ,SAAU,CAAEnJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAC3BkJ,WAAY,CAAEpJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,IAC7BmJ,WAAY,CAAErJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,IAE7BoJ,MAAO,CAAEtJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,IAEpBqJ,EAAoB,CACxBjD,EAAG,CAAEtG,EAAG,EAAGC,EAAG,GAAKC,EAAG,GACtBkB,EAAG,CAAEpB,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACpBwI,EAAG,CAAE1I,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACpB5B,EAAG,CAAE0B,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACpB6H,EAAG,CAAE/H,EAAG,EAAGC,EAAG,GAAKC,EAAG,GACtByI,EAAG,CAAE3I,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACpB0I,EAAG,CAAE5I,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACpB2I,EAAG,CAAE7I,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAEpB8I,YAAa,CAAEhJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAC9BgJ,SAAU,CAAElJ,EAAG,EAAGC,EAAG,GAAIC,EAAG,GAC5BiJ,SAAU,CAAEnJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAC3BkJ,WAAY,CAAEpJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAC7BmJ,WAAY,CAAErJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAE7BoJ,MAAO,CAAEtJ,EAAG,EAAGC,EAAG,GAAKC,EAAG,IAEtBsJ,EAAc,CAClBC,MAAO,CAAEzJ,EAAG,EAAGC,EAAG,GAClByJ,MAAO,CAAE1J,EAAG,EAAGC,EAAG,GAClB0J,MAAO,CAAE3J,EAAG,EAAGC,EAAG,GAClB2J,MAAO,CAAE5J,EAAG,EAAGC,EAAG,GAClB4J,MAAO,CAAE7J,EAAG,EAAGC,EAAG,GAClB6J,MAAO,CAAE9J,EAAG,EAAGC,GAAI,GACnB8J,MAAO,CAAE/J,EAAG,EAAGC,GAAI,GACnB+J,MAAO,CAAEhK,EAAG,EAAGC,GAAI,GACnBgK,MAAO,CAAEjK,EAAG,EAAGC,GAAI,IAEfiK,EAAkB,CACtBC,SAAU,4BACVC,SAAU,2BACVd,MAAO,MAEHe,E,kDACJ,WAAYtK,GAAQ,IAAD,8BACjB,cAAMA,IACDuK,MAAQ,CACXC,MAAO,MAET,EAAKC,aAAe,EAAKA,aAAa7K,KAAlB,gBALH,E,+DAQjB,IAAM8K,EAAQtC,KAAKpI,MAAM2K,MAAMC,OAAOJ,MAAM9E,MAAM,KAC5C8E,EAAQE,EAAM,GAOpB,GANAtC,KAAKyC,SAAS,CACZL,MAAOA,EACP5D,MAAM,GAAD,OAAKhE,EAAL,gBAAsB4H,EAAtB,YAA+BA,EAA/B,QACLpH,QAAQ,GAAD,OAAKR,EAAL,gBAAsB4H,EAAtB,YAA+BA,EAA/B,QACP3D,KAAK,GAAD,OAAKjE,EAAL,4BAAkC4H,EAAlC,gBAEFE,EAAM/L,OAAS,EACjByJ,KAAKyC,SAAS,CAAEzH,QAAQ,GAAD,OAAKR,EAAL,gBAAsB8H,EAAM,GAA5B,YAAkCA,EAAM,GAAxC,eAClB,GAAIA,EAAM/L,OAAS,EACxByJ,KAAKyC,SAAS,CAAEzH,QAAQ,GAAD,OAAKR,EAAL,gBAAsB4H,EAAtB,YAA+BE,EAAM,GAArC,cAClB,CACL,GAAiB,MAAbF,EAAM,IAA2B,MAAbA,EAAM,GAAY,CACxC,IAAIM,EAAgBN,EAAMO,UAAU,EAAG,GAAK,IAC5C3C,KAAKyC,SAAS,CAAEzH,QAAQ,GAAD,OAAKR,EAAL,gBAAsBkI,EAAtB,YAAuCA,EAAvC,UAER,MAAbN,EAAM,IACRpC,KAAKyC,SAAS,CAAEzH,QAAQ,GAAD,OAAKR,EAAL,gBAAsB4H,EAAtB,YAA+BA,EAA/B,aAEO,MAA5BA,EAAMA,EAAM7L,OAAS,IACvByJ,KAAKyC,SAAS,CAAEzH,QAAS,OAEvB+G,EAAgBK,IAClBpC,KAAKyC,SAAS,CAAEzH,QAAQ,GAAD,OAAKR,EAAL,gBAAsBuH,EAAgBK,S,0CAKjEpC,KAAK4C,qB,yCAEYC,GACb7C,KAAKpI,MAAMkL,WAAaD,EAAUC,UACpC9C,KAAK4C,qB,mCAGIhD,GACXI,KAAKyC,SAAL,eACG7C,EAAE/F,OAAO+B,KAAOgE,EAAE/F,OAAOkJ,U,+BAI5B,QAAyB5F,IAArB6C,KAAKmC,MAAM3D,MACb,OAAO,kBAAC,IAAMwE,SAAP,MAET,IAIM/K,EAAW,CACfC,MAAOC,OAAOC,WACdC,OAAQF,OAAOG,YAAc,GAEzB2K,EAAOjD,KAAKmC,MAAMC,MAAM,GAC1BzK,EAAiB2I,EAAgB2C,GACjC3C,EAAgBN,KAAKmC,MAAMC,SAC7BzK,EAAiB2I,EAAgBN,KAAKmC,MAAMC,QAE9C,IAAIpK,EAAmBoJ,EAAkB6B,GACrC7B,EAAkBpB,KAAKmC,MAAMC,SAC/BpK,EAAmBoJ,EAAkBpB,KAAKmC,MAAMC,QAElD,IAAIrF,EAAW,CACblF,EAAG,EACHC,EAAG,EACHC,EAAG,EACHmL,MAAO,OAET,GAAIlD,KAAKpI,MAAM2K,MAAMC,OAAOzF,SAAU,CACpC,IAAMoG,EAAMnD,KAAKpI,MAAM2K,MAAMC,OAAOzF,SAASO,MAAM,KAChC,IAAf6F,EAAI5M,SACNwG,EAAW,CACTlF,EAAGuL,WAAWD,EAAI,IAClBrL,EAAGsL,WAAWD,EAAI,IAClBpL,EAAGqL,WAAWD,EAAI,MAIxB,GAAInD,KAAKpI,MAAM2K,MAAMC,OAAOxK,iBAAkB,CAC5C,IAAMqL,EAAOrD,KAAKpI,MAAM2K,MAAMC,OAAOxK,iBAAiBsF,MAAM,KACxC,IAAhB+F,EAAK9M,SACPyB,EAAmB,CACjBH,EAAGuL,WAAWC,EAAK,IACnBvL,EAAGsL,WAAWC,EAAK,IACnBtL,EAAGqL,WAAWC,EAAK,MAIzB,GAAIrD,KAAKpI,MAAM2K,MAAMC,OAAO7K,eAAgB,CAC1C,IAAM2L,EAAMtD,KAAKpI,MAAM2K,MAAMC,OAAO7K,eAAe2F,MAAM,KACtC,IAAfgG,EAAI/M,SACNoB,EAAiB,CACfE,EAAGuL,WAAWE,EAAI,IAClBxL,EAAGsL,WAAWE,EAAI,IAClBvL,EAAGqL,WAAWE,EAAI,MAIxB,IAAI5H,EAAa,CAAE7D,EAAG,EAAGC,EAAG,GACxBkI,KAAKpI,MAAM2K,MAAMC,OAAOe,MAAQlC,EAAYrB,KAAKpI,MAAM2K,MAAMC,OAAOe,QACtE7H,EAAa2F,EAAYrB,KAAKpI,MAAM2K,MAAMC,OAAOe,OAEnD,IAAIpI,GAAY,EACZ8D,GAAW,EACXjB,GAAU,EACd,GAAIgC,KAAKpI,MAAM2K,MAAMC,OAAOgB,WAAY,CACtC,IAAMC,EAAKzD,KAAKpI,MAAM2K,MAAMC,OAAOgB,WAAW,GAC9C,GAAW,MAAPC,EAAY,CACd,IAAIC,EAAQ,KACkC,MAA1C1D,KAAKpI,MAAM2K,MAAMC,OAAOgB,WAAW,IACrCE,EAAQC,SAAS3D,KAAKpI,MAAM2K,MAAMC,OAAOgB,WAAWb,UAAU,IAC9D3E,GAAU,GAEV0F,EAAQC,SAAS3D,KAAKpI,MAAM2K,MAAMC,OAAOgB,WAAWb,UAAU,KAE3DiB,MAAMF,IAAUA,EAAQ,IAC3BzE,EAAW,EAAIyE,EACX1F,IACFA,EAAU0F,EAAQ,UAGN,MAAPD,IACTtI,GAAY,GAIhB,OACE,6BACE,kBAAC,EAAD,CACEqD,MAAOwB,KAAKmC,MAAM3D,MAClBxD,QAASgF,KAAKmC,MAAMnH,QACpByD,KAAMuB,KAAKmC,MAAM1D,KAGjBoF,gBAzFkB,EA0FlBtL,MAzFQ,EA0FRE,KAzFO,EA0FPD,IAzFM,IA2FNkD,WAAYA,EACZP,UAAWA,EACX8D,SAAUA,EACVjB,QAASA,EACT/F,SAAUA,EACV8E,SAAUA,EACVpF,eAAgBA,EAChBK,iBAAkBA,EAClBoF,aAAc4C,KAAKpI,MAAM2K,MAAMC,OAAOpF,oB,GA5J5BgD,IAAMC,WAmKXyD,cAAW5B,G,QC5NnB,SAAS6B,IACZ,IAAMC,EAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvC,OACI,6BAEQC,OAAOC,KAAKC,EAAOhG,GAAG7G,KAAI,SAAA8M,GACtB,IAAIC,EAAMF,EAAOhG,EAAEiG,GACfE,EAAmB,OAAZD,EAAIC,KAAgBD,EAAIC,IAAI/N,OAAS,GAAM,OAAS,MAC/D,OACI,yBAAK6I,MAAO,CAAEmF,MAAO,OAAQrM,MAAO,MAAOsM,SAAU,IAAKC,UAAW,IAAKC,OAAQ,GAAKC,IAAKP,GACxF,6BAAMC,EAAIzI,MACV,kBAAC,IAAD,CAAMgJ,GAAE,WAAMR,IAAOA,GAFzB,IAEoC,6BAChC,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,EAAN,oBAAR,OAHJ,IAGkD,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,EAAN,oBAAR,QAHlD,IAGiG,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,EAAN,oBAAR,OAHjG,IAG4J,OAAZC,EAAIC,KAAgB,kBAAC,IAAD,CAAMM,GAAE,WAAMR,EAAN,YAAYE,EAAZ,YAAmBD,EAAIC,MAA/B,OAHpK,IAGsN,6BAHtN,UAIYN,EAAM1M,KAAI,SAAAuN,GAAE,OAAI,kBAAC,IAAM7B,SAAP,CAAgB2B,IAAKE,GAAI,kBAAC,IAAD,CAAMD,GAAE,WAAMR,EAAN,kBAAkBS,IAAOA,GAA1D,QAJ5B,IAIqH,6BACjH,kBAAC,IAAD,CAAMD,GAAE,WAAMR,EAAN,WAAR,aALJ,IAK+C,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,EAAN,aAAR,iBAQhE,SAASU,IACZ,OACI,6BAEQb,OAAOC,KAAKC,EAAOlL,GAAG3B,KAAI,SAAA8M,GACtB,IAAIxI,EAAOuI,EAAOlL,EAAEmL,GAAIxI,KACxB,OACI,yBAAKwD,MAAO,CAAEmF,MAAO,OAAQrM,MAAO,MAAOsM,SAAU,IAAKC,UAAW,GAAIC,OAAQ,GAAKC,IAAKP,GACvF,6BAAMxI,GACN,kBAAC,IAAD,CAAMgJ,GAAE,WAAMR,IAAOA,GAFzB,IAEoC,6BAChC,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,EAAN,WAAR,aAHJ,IAG+C,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,EAAN,aAAR,iBAQhE,SAASW,IACZ,OACI,6BAEQd,OAAOC,KAAKC,EAAO5D,GAAGjJ,KAAI,SAAA8M,GACtB,IAAMnB,EAAOkB,EAAO5D,EAAE6D,GAAIY,GACpBpJ,EAAOuI,EAAO5D,EAAE6D,GAAIxI,KACpBqJ,EAAKd,EAAO5D,EAAE6D,GAAIa,GACxB,OACI,yBAAK7F,MAAO,CAAEmF,MAAO,OAAQrM,MAAO,MAAOsM,SAAU,IAAKC,UAAW,GAAIC,OAAQ,GAAKC,IAAKP,GACvF,6BAAMnB,EAAK,6BAAOrH,GAClB,kBAAC,IAAD,CAAMgJ,GAAE,WAAMR,IAAOA,GAFzB,IAEqCa,GAAM,kBAAC,IAAD,CAAML,GAAE,WAAMK,IAAd,MAF3C,IAE0E,6BACtE,kBAAC,IAAD,CAAML,GAAE,WAAMR,EAAN,WAAR,aAHJ,IAG+C,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,EAAN,aAAR,iBAQhE,SAASc,IACZ,OACI,6BAEQf,EAAOgB,MAAM7N,KAAI,SAAA8M,GACb,OACI,yBAAKhF,MAAO,CAAEmF,MAAO,OAAQa,UAAW,SAAUlN,MAAO,GAAIG,OAAQ,IAAMsM,IAAKP,GAC5E,kBAAC,IAAD,CAAMQ,GAAE,WAAMR,IAAOA,QCpE1C,IAAM5J,EAAY6K,UAyBVC,E,uKArBX,OACE,kBAAC,IAAD,CAAYC,SAAS,KACnB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,KAChB,4BACE,4BAAI,kBAAC,IAAD,CAAMb,GAAE,cAAR,cACJ,4BAAI,kBAAC,IAAD,CAAMA,GAAE,WAAR,WACJ,4BAAI,kBAAC,IAAD,CAAMA,GAAE,WAAR,WACJ,4BAAI,kBAAC,IAAD,CAAMA,GAAE,UAAR,YAGR,kBAAC,IAAD,CAAOY,OAAK,EAACC,KAAK,aAAaC,UAAW3B,IAC1C,kBAAC,IAAD,CAAOyB,OAAK,EAACC,KAAK,UAAUC,UAAWZ,IACvC,kBAAC,IAAD,CAAOU,OAAK,EAACC,KAAK,UAAUC,UAAWX,IACvC,kBAAC,IAAD,CAAOS,OAAK,EAACC,KAAK,SAASC,UAAWR,IACtC,kBAAC,IAAD,CAAOO,KAAK,4FAA4FC,UAAWxD,U,GAjB3G9B,IAAMC,WCKlBsF,EAAcvK,QACW,cAA7BjD,OAAO2K,SAAS8C,UAEe,UAA7BzN,OAAO2K,SAAS8C,UAEhBzN,OAAO2K,SAAS8C,SAASrD,MACvB,2DAsCN,SAASsD,EAAgBC,EAAOC,GAC9BC,UAAUC,cACPC,SAASJ,GACTK,MAAK,SAAAC,GACJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiBnE,QACf6D,UAAUC,cAAcQ,YAI1BC,QAAQC,IACN,iHAKEZ,GAAUA,EAAOa,UACnBb,EAAOa,SAASR,KAMlBM,QAAQC,IAAI,sCAGRZ,GAAUA,EAAOc,WACnBd,EAAOc,UAAUT,WAO5BU,OAAM,SAAAlI,GACL8H,QAAQ9H,MAAM,4CAA6CA,MC1FjEmI,IAASzN,OAAO,kBAAC,EAAD,MAAS0N,SAASC,eAAe,SDgB1C,SAAkBlB,GACvB,GAA6C,kBAAmBC,UAAW,CAGzE,GADkB,IAAIkB,IAAI7B,UAAwBlN,OAAO2K,SAASqE,MACpDC,SAAWjP,OAAO2K,SAASsE,OAIvC,OAGFjP,OAAOkP,iBAAiB,QAAQ,WAC9B,IAAMvB,EAAK,UAAMT,UAAN,sBAEPM,IAgEV,SAAiCG,EAAOC,GAEtCuB,MAAMxB,GACHK,MAAK,SAAAoB,GAEJ,IAAMC,EAAcD,EAASE,QAAQzQ,IAAI,gBAEnB,MAApBuQ,EAASG,QACO,MAAfF,IAA8D,IAAvCA,EAAYG,QAAQ,cAG5C3B,UAAUC,cAAc2B,MAAMzB,MAAK,SAAAC,GACjCA,EAAayB,aAAa1B,MAAK,WAC7BhO,OAAO2K,SAASgF,eAKpBjC,EAAgBC,EAAOC,MAG1Be,OAAM,WACLJ,QAAQC,IACN,oEArFAoB,CAAwBjC,EAAOC,GAI/BC,UAAUC,cAAc2B,MAAMzB,MAAK,WACjCO,QAAQC,IACN,iHAMJd,EAAgBC,EAAOC,OCvC/BE,K","file":"static/js/main.23d8ef58.chunk.js","sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport * as THREE from \"three\";\r\nimport { fbxSource } from \"./App\";\r\n\r\nlet OrbitControls = require(\"three-orbit-controls\")(THREE);\r\nlet FBXLoader = require(\"three-fbxloader-offical\");\r\n\r\nfunction parallelTraverse(a, b, callback) {\r\n  callback(a, b);\r\n  for (var i = 0; i < a.children.length; i++) {\r\n    parallelTraverse(a.children[i], b.children[i], callback);\r\n  }\r\n}\r\nfunction skeleClone(source) {\r\n  var sourceLookup = new Map();\r\n  var cloneLookup = new Map();\r\n  var clone = source.clone();\r\n  parallelTraverse(source, clone, function (sourceNode, clonedNode) {\r\n    sourceLookup.set(clonedNode, sourceNode);\r\n    cloneLookup.set(sourceNode, clonedNode);\r\n  });\r\n  clone.traverse(function (node) {\r\n    if (!node.isSkinnedMesh) return;\r\n    var clonedMesh = node;\r\n    var sourceMesh = sourceLookup.get(node);\r\n    var sourceBones = sourceMesh.skeleton.bones;\r\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\r\n    clonedMesh.bindMatrix.copy(sourceMesh.bindMatrix);\r\n    clonedMesh.skeleton.bones = sourceBones.map(function (bone) {\r\n      return cloneLookup.get(bone);\r\n    });\r\n    clonedMesh.bind(clonedMesh.skeleton, clonedMesh.bindMatrix);\r\n  });\r\n  return clone;\r\n}\r\n\r\nexport default class ReactThreeVisor extends React.Component {\r\n  static propTypes = {\r\n    model: PropTypes.string,\r\n    texture: PropTypes.string,\r\n    backgroundColor: PropTypes.number,\r\n    viewport: PropTypes.object,\r\n    cameraPosition: PropTypes.object,\r\n    controlsPosition: PropTypes.object,\r\n    angle: PropTypes.number,\r\n    far: PropTypes.number,\r\n    near: PropTypes.number,\r\n    onError: PropTypes.func,\r\n    onLoading: PropTypes.func,\r\n    zoom: PropTypes.number\r\n  };\r\n\r\n  checkProps = () => {\r\n    this.cameraPosition = this.props.cameraPosition || { x: 2, y: 0, z: 10 };\r\n    this.controlsPosition = this.props.controlsPosition || { x: 0, y: 0, z: 0 };\r\n    this.viewport = this.props.viewport || {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight\r\n    };\r\n    this.angle = this.props.angle || 45;\r\n    this.far = this.props.far || 2000;\r\n    this.near = this.props.near || 1;\r\n    this.lights = this.props.ligths || null;\r\n    this.zoom = this.props.zoom || 1;\r\n  };\r\n\r\n  // onWindowResize = () => {\r\n  //     this.camera.aspect = this.viewport.width / this.viewport.height;\r\n  //     this.camera.updateProjectionMatrix();\r\n  //     this.renderer.setSize(this.viewport.width, this.viewport.height);\r\n  // }\r\n\r\n  animate = () => {\r\n    this.animation = requestAnimationFrame(this.animate);\r\n    if (this.mixers.length > 0) {\r\n      const d = this.clock.getDelta();\r\n      for (var i = 0; i < this.mixers.length; i++) {\r\n        this.mixers[i].update(d);\r\n      }\r\n    }\r\n    this.renderer.render(this.scene, this.camera);\r\n  };\r\n  init = () => {\r\n    // mixers\r\n    this.mixers = [];\r\n    this.clock = new THREE.Clock();\r\n\r\n    // Camera\r\n    this.camera = new THREE.PerspectiveCamera(\r\n      this.angle,\r\n      this.viewport.width / this.viewport.height,\r\n      this.near,\r\n      this.far\r\n    );\r\n    this.camera.position.set(\r\n      this.cameraPosition.x,\r\n      this.cameraPosition.y,\r\n      this.cameraPosition.z\r\n    );\r\n    this.camera.zoom = this.zoom;\r\n    this.camera.updateProjectionMatrix();\r\n\r\n    // Controls\r\n    this.controls = new OrbitControls(this.camera);\r\n    this.controls.target.set(\r\n      this.controlsPosition.x,\r\n      this.controlsPosition.y,\r\n      this.controlsPosition.z\r\n    );\r\n    this.controls.update();\r\n\r\n    // Scene\r\n    this.scene = new THREE.Scene();\r\n    // this.scene.background = new THREE.Color(this.props.backgroundColor);\r\n    // this.scene.background = new THREE.Color(0xfdfdfd);\r\n    this.scene.fog = new THREE.Fog(0xa0a0a0, 200, 1000);\r\n\r\n    // Light\r\n    let light = new THREE.HemisphereLight(0xffffff, 0x444444);\r\n    light.position.set(0, 200, 0);\r\n    this.scene.add(light);\r\n    light = new THREE.DirectionalLight(0xffffff);\r\n    light.position.set(0, 200, 100);\r\n    light.castShadow = false;\r\n    light.shadow.camera.top = 180;\r\n    light.shadow.camera.bottom = -100;\r\n    light.shadow.camera.left = -120;\r\n    light.shadow.camera.right = 120;\r\n    light = new THREE.DirectionalLight(0xffffff);\r\n    this.scene.add(light);\r\n    light = new THREE.AmbientLight(0x222222);\r\n    this.scene.add(light);\r\n    this.matcap = `${fbxSource}/MatCapProjection_000.png`\r\n    // model\r\n    const loaderCallback = (object, textureFile, richFile, offset) => {\r\n      let material = null;\r\n      if (textureFile !== null) {\r\n        const txLoader = new THREE.TextureLoader();\r\n        const texture = txLoader.load(textureFile);\r\n        const rich = txLoader.load(richFile);\r\n        const matcap = txLoader.load(this.matcap);\r\n        material = new THREE.MeshMatcapMaterial({\r\n          map: texture,\r\n          // normalMap: rich,\r\n          matcap: matcap,\r\n          skinning: true,\r\n          wireframe: Boolean(this.props.wireframe)\r\n        });\r\n      }\r\n      const applyMaterial = (materials, newMaterial) => {\r\n        if (Array.isArray(materials)) {\r\n          return materials.map(() => {\r\n            return newMaterial;\r\n          });\r\n        } else {\r\n          return newMaterial;\r\n        }\r\n      }\r\n      const convertMaterial = (materials) => {\r\n        if (Array.isArray(materials)) {\r\n          return materials.map((m) => {\r\n            return new THREE.MeshMatcapMaterial({\r\n              map: m.map,\r\n              // normalMap: m.normalMap,\r\n              matcap: m.matcap,\r\n              skinning: true,\r\n              wireframe: Boolean(this.props.wireframe)\r\n            });\r\n          });\r\n        } else {\r\n          return new THREE.MeshMatcapMaterial({\r\n            map: materials.map,\r\n            // normalMap: materials.normalMap,\r\n            // matcap: materials.matcap,\r\n            skinning: true,\r\n            wireframe: Boolean(this.props.wireframe)\r\n          });\r\n        }\r\n      }\r\n      const faceOffset = this.props.faceOffset;\r\n      object.traverse(function (child) {\r\n        if (child.name.includes('Eff')) {\r\n          child.visible = false;\r\n        }\r\n        if (child.isMesh && child.name !== 'simpleBodyAll') {\r\n          if (material !== null) {\r\n            child.material = applyMaterial(child.material, material);\r\n          } else {\r\n            child.material = convertMaterial(child.material);\r\n          }\r\n          // child.castShadow = false;\r\n          // child.receiveShadow = false;\r\n        }\r\n\r\n        if (child.name === 'mBodyAll') {\r\n          // 1: 2, 1\r\n          // 2: 0, 0\r\n          // 3: 1, 0\r\n          // 4: 2, 0\r\n          // 5: 3, 0\r\n          // 6: 0, -1\r\n          // 7: 1, -1\r\n          // 8: 2, -1\r\n          // 9: 3, -1\r\n          if (faceOffset && child.geometry.groups.length === 3) {\r\n            const faceGroups = child.geometry.groups.filter(k => {\r\n              return k.count < 1000;\r\n            });\r\n            if (faceGroups.length === 2) {\r\n              const start = Math.min(faceGroups[0].start, faceGroups[1].start);\r\n              const end = Math.max(faceGroups[0].start + faceGroups[0].count, faceGroups[1].start + faceGroups[1].count);\r\n              for (let i = start; i < end; i += 1) {\r\n                child.geometry.attributes.uv.array[i * 2] += 0.25 * faceOffset.x;\r\n                child.geometry.attributes.uv.array[i * 2 + 1] += 0.25 * faceOffset.y;\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n      });\r\n      if (this.props.rotation) {\r\n        object.rotation.x = this.props.rotation.x;\r\n        object.rotation.y = this.props.rotation.y;\r\n        object.rotation.z = this.props.rotation.z;\r\n      }\r\n      if (offset !== null) {\r\n        object.position.add(offset);\r\n      }\r\n\r\n      const addAnimation = (object) => {\r\n        object.mixer = new THREE.AnimationMixer(object);\r\n        if (object.mixer) {\r\n          this.mixers.push(object.mixer);\r\n        }\r\n        if (this.props.animationIdx !== undefined) {\r\n          if (this.props.animationIdx.includes(\"+\")) {\r\n            const args = this.props.animationIdx.split(\"+\");\r\n            if (args.length === 2) {\r\n              const aniFile = args[0];\r\n              const aniName = args[1];\r\n              const ani = `${fbxSource}/fbx/${aniFile}.fbx`;\r\n              let aniLoader = new FBXLoader();\r\n              aniLoader.load(ani, obj => {\r\n                const animation = obj.animations.find(a => a.name === aniName);\r\n                if (animation) {\r\n                  let action = object.mixer.clipAction(animation);\r\n                  action.play();\r\n                }\r\n              });\r\n            }\r\n          } else if (object.animations && object.animations[this.props.animationIdx]) {\r\n            let action = object.mixer.clipAction(object.animations[this.props.animationIdx]);\r\n            action.play();\r\n          }\r\n        }\r\n      }\r\n      addAnimation.bind(this);\r\n      addAnimation(object);\r\n\r\n      const outRatio = this.props.outline;\r\n      if (outRatio > 0) {\r\n        const outline = skeleClone(object);\r\n        outline.position.add(new THREE.Vector3(0, -outRatio / 1.5, 0));\r\n        outline.scale.multiplyScalar(1 + outRatio);\r\n        outline.traverse(function (c) {\r\n          if (c.isMesh) {\r\n            const outlineMaterial = new THREE.MeshBasicMaterial({\r\n              color: 0x000000,\r\n              skinning: true,\r\n              side: THREE.BackSide\r\n            });\r\n            c.material = applyMaterial(c.material, outlineMaterial);\r\n            c.castShadow = false;\r\n            c.receiveShadow = false;\r\n          }\r\n        });\r\n        addAnimation(outline);\r\n        this.scene.add(outline);\r\n      }\r\n      this.scene.add(object);\r\n    };\r\n    loaderCallback.bind(this);\r\n    if (this.props.model) {\r\n      let loader = new FBXLoader();\r\n      loader.load(\r\n        this.props.model,\r\n        object => {\r\n          loaderCallback(object, this.props.texture, this.props.rich, null);\r\n        },\r\n        s => {\r\n          this.handleLoad(s);\r\n        },\r\n        error => {\r\n          this.handleError(error);\r\n        }\r\n      );\r\n    }\r\n    // if (this.props.ex) {\r\n    //   let loader = new FBXLoader();\r\n    //   loader.load(\r\n    //     this.props.ex,\r\n    //     object => {\r\n    //       const offset = new THREE.Vector3(0, 0.25, 0);\r\n    //       if (this.props.exTexture) {\r\n    //         loaderCallback(object, this.props.exTexture, offset);\r\n    //       } else {\r\n    //         loaderCallback(object, this.props.texture, offset);\r\n    //       }\r\n    //     },\r\n    //     s => {\r\n    //       this.handleLoad(s);\r\n    //     },\r\n    //     error => {\r\n    //       this.handleError(error);\r\n    //     }\r\n    //   );\r\n    // }\r\n\r\n    this.renderer = new THREE.WebGLRenderer({ antialias: false, alpha: true });\r\n    this.renderer.setClearColor(0x000000, 0);\r\n    // Renderer\r\n    if (this.props.pixelate) {\r\n      this.renderer.setPixelRatio(this.props.pixelate);\r\n      this.renderer.domElement.style.cssText = 'image-rendering:crisp-edges;image-rendering:pixelated;';\r\n    } else {\r\n      this.renderer.setPixelRatio(window.devicePixelRatio);\r\n    }\r\n    // this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    this.renderer.setSize(this.viewport.width, this.viewport.height);\r\n    // this.renderer.setViewport(0, 0, this.viewport.width, this.viewport.height);\r\n    this.renderer.shadowMap.enabled = true;\r\n    this.container.appendChild(this.renderer.domElement);\r\n    // window.addEventListener('resize', this.onWindowResize.bind(this), false);\r\n    this.animate();\r\n  };\r\n\r\n  handleLoad = e => {\r\n    if (this.props.onLoad) {\r\n      this.props.onLoading(e);\r\n    }\r\n  };\r\n\r\n  handleError = e => {\r\n    if (this.props.onError) {\r\n      this.props.onError(e);\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.checkProps();\r\n    this.init();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    cancelAnimationFrame(this.animation);\r\n    this.mixers = null;\r\n    this.clock = null;\r\n    this.camera = null;\r\n    this.controls = null;\r\n    this.scene = null;\r\n    this.renderer = null;\r\n  }\r\n  render() {\r\n    return (\r\n      <div\r\n        ref={el => {\r\n          this.container = el;\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactThreeFbxViewer from \"./Viewer\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { fbxSource } from \"./App\";\r\n// import fbxIdx from './fbx/index.json';\r\n\r\n// let fbxUrl = require('./fbx/asd.fbx');\r\n\r\nconst cameraPositions = {\r\n  c: { x: 0, y: 0.5, z: 1.5 },\r\n  d: { x: 3, y: 0.5, z: 6 },\r\n  w: { x: 2, y: 0, z: 0 },\r\n  b: { x: 1, y: 0.5, z: 6 },\r\n  e: { x: 1, y: 1, z: 4 },\r\n  h: { x: 1, y: 0.5, z: 3 },\r\n  o: { x: 0, y: 0.5, z: 8 },\r\n  r: { x: 3, y: 3, z: 20 },\r\n\r\n  c100034_01: { x: 0, y: 0.5, z: 1.75 },\r\n  h0010001: { x: 6, y: 0.5, z: 8 },\r\n  h0010001_02: { x: 2, y: 0, z: 0 },\r\n  h0040101: { x: 1, y: 0.5, z: 4 },\r\n  r0070401: { x: 30, y: 30, z: 100 },\r\n  r0080401: { x: 1, y: 2, z: 5 },\r\n  d210078_01: { x: 3, y: 3, z: 20 },\r\n  d210114_01: { x: 3, y: 3, z: 20 },\r\n\r\n  smith: { x: 1, y: 1, z: 2 }\r\n};\r\nconst controlsPositions = {\r\n  c: { x: 0, y: 0.5, z: 0 },\r\n  d: { x: 0, y: 1, z: 0 },\r\n  w: { x: 0, y: 0, z: 0 },\r\n  b: { x: 0, y: 1, z: 0 },\r\n  e: { x: 0, y: 0.5, z: 0 },\r\n  h: { x: 0, y: 1, z: 0 },\r\n  o: { x: 0, y: 0, z: 0 },\r\n  r: { x: 0, y: 3, z: 0 },\r\n\r\n  h0010001_02: { x: 0, y: 3, z: 0 },\r\n  r0070401: { x: 0, y: 20, z: 0 },\r\n  r0080401: { x: 0, y: 2, z: 0 },\r\n  d210078_01: { x: 0, y: 3, z: 0 },\r\n  d210114_01: { x: 0, y: 3, z: 0 },\r\n\r\n  smith: { x: 0, y: 0.5, z: 0 }\r\n};\r\nconst faceOffsets = {\r\n  face1: { x: 2, y: 1 },\r\n  face2: { x: 0, y: 0 },\r\n  face3: { x: 1, y: 0 },\r\n  face4: { x: 2, y: 0 },\r\n  face5: { x: 3, y: 0 },\r\n  face6: { x: 0, y: -1 },\r\n  face7: { x: 1, y: -1 },\r\n  face8: { x: 2, y: -1 },\r\n  face9: { x: 3, y: -1 },\r\n}\r\nconst textureOverride = {\r\n  r0060401: 'd210078_01/d210078_01.png',\r\n  o0090401: 'r0060401/r0060401_02.png',\r\n  smith: null\r\n}\r\nclass Model extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      asset: null\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n  }\r\n  updateModelState() {\r\n    const parts = this.props.match.params.asset.split('+');\r\n    const asset = parts[0];\r\n    this.setState({\r\n      asset: asset,\r\n      model: `${fbxSource}/fbx/${asset}/${asset}.fbx`,\r\n      texture: `${fbxSource}/fbx/${asset}/${asset}.png`,\r\n      rich: `${fbxSource}/characters_rich/${asset}_multi.png`\r\n    });\r\n    if (parts.length > 2) {\r\n      this.setState({ texture: `${fbxSource}/fbx/${parts[1]}/${parts[2]}.png` });\r\n    } else if (parts.length > 1) {\r\n      this.setState({ texture: `${fbxSource}/fbx/${asset}/${parts[1]}.png` });\r\n    } else {\r\n      if (asset[0] === 'w' && asset[9] === '2') {\r\n        let texture_asset = asset.substring(0, 9) + '1';\r\n        this.setState({ texture: `${fbxSource}/fbx/${texture_asset}/${texture_asset}.png` });\r\n      }\r\n      if (asset[0] === 'r') {\r\n        this.setState({ texture: `${fbxSource}/fbx/${asset}/${asset}_01.png` });\r\n      }\r\n      if (asset[asset.length - 1] === 'h') {\r\n        this.setState({ texture: null });\r\n      }\r\n      if (textureOverride[asset]) {\r\n        this.setState({ texture: `${fbxSource}/fbx/${textureOverride[asset]}` });\r\n      }\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    this.updateModelState();\r\n  }\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.location !== prevProps.location) {\r\n      this.updateModelState();\r\n    }\r\n  }\r\n  handleChange(e) {\r\n    this.setState({\r\n      [e.target.name]: e.target.value\r\n    });\r\n  }\r\n  render() {\r\n    if (this.state.model === undefined) {\r\n      return <React.Fragment></React.Fragment>;\r\n    }\r\n    const backgroundColor = 0x000000;\r\n    const angle = 0;\r\n    const near = 1;\r\n    const far = 1000;\r\n    const viewport = {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight - 5\r\n    };\r\n    const type = this.state.asset[0];\r\n    let cameraPosition = cameraPositions[type];\r\n    if (cameraPositions[this.state.asset]) {\r\n      cameraPosition = cameraPositions[this.state.asset];\r\n    }\r\n    let controlsPosition = controlsPositions[type];\r\n    if (controlsPositions[this.state.asset]) {\r\n      controlsPosition = controlsPositions[this.state.asset];\r\n    }\r\n    let rotation = {\r\n      x: 0,\r\n      y: 0,\r\n      z: 0,\r\n      order: 'XYZ'\r\n    }\r\n    if (this.props.match.params.rotation) {\r\n      const rot = this.props.match.params.rotation.split(',');\r\n      if (rot.length === 3) {\r\n        rotation = {\r\n          x: parseFloat(rot[0]),\r\n          y: parseFloat(rot[1]),\r\n          z: parseFloat(rot[2]),\r\n        }\r\n      }\r\n    }\r\n    if (this.props.match.params.controlsPosition) {\r\n      const ctrl = this.props.match.params.controlsPosition.split(',');\r\n      if (ctrl.length === 3) {\r\n        controlsPosition = {\r\n          x: parseFloat(ctrl[0]),\r\n          y: parseFloat(ctrl[1]),\r\n          z: parseFloat(ctrl[2]),\r\n        }\r\n      }\r\n    }\r\n    if (this.props.match.params.cameraPosition) {\r\n      const cam = this.props.match.params.cameraPosition.split(',');\r\n      if (cam.length === 3) {\r\n        cameraPosition = {\r\n          x: parseFloat(cam[0]),\r\n          y: parseFloat(cam[1]),\r\n          z: parseFloat(cam[2]),\r\n        }\r\n      }\r\n    }\r\n    let faceOffset = { x: 0, y: 0 };\r\n    if (this.props.match.params.face && faceOffsets[this.props.match.params.face]) {\r\n      faceOffset = faceOffsets[this.props.match.params.face];\r\n    }\r\n    let wireframe = false;\r\n    let pixelate = false;\r\n    let outline = false;\r\n    if (this.props.match.params.renderMode) {\r\n      const rm = this.props.match.params.renderMode[0];\r\n      if (rm === 'p') {\r\n        let ratio = null;\r\n        if (this.props.match.params.renderMode[1] === 'x') {\r\n          ratio = parseInt(this.props.match.params.renderMode.substring(2));\r\n          outline = true;\r\n        } else {\r\n          ratio = parseInt(this.props.match.params.renderMode.substring(1));\r\n        }\r\n        if (!isNaN(ratio) && ratio > 0) {\r\n          pixelate = 1 / ratio;\r\n          if (outline) {\r\n            outline = ratio / 100;\r\n          }\r\n        }\r\n      } else if (rm === 'w') {\r\n        wireframe = true;\r\n      }\r\n    }\r\n    // const zoom = 7;\r\n    return (\r\n      <div>\r\n        <ReactThreeFbxViewer\r\n          model={this.state.model}\r\n          texture={this.state.texture}\r\n          rich={this.state.rich}\r\n          // ex={this.state.ex}\r\n          // exTexture={this.state.exTexture}\r\n          backgroundColor={backgroundColor}\r\n          angle={angle}\r\n          near={near}\r\n          far={far}\r\n          // zoom={zoom}\r\n          faceOffset={faceOffset}\r\n          wireframe={wireframe}\r\n          pixelate={pixelate}\r\n          outline={outline}\r\n          viewport={viewport}\r\n          rotation={rotation}\r\n          cameraPosition={cameraPosition}\r\n          controlsPosition={controlsPosition}\r\n          animationIdx={this.props.match.params.animationIdx}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Model);\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport fbxIdx from './index.json';\r\n\r\n// style={{ float: \"left\", width: \"15%\", margin: 5 }}\r\n\r\nexport function CharacterIndex() {\r\n    const faces = [1, 2, 3, 4, 5, 6, 7, 8, 9];\r\n    return (\r\n        <div>\r\n            {\r\n                Object.keys(fbxIdx.c).map(fn => {\r\n                    let nwt = fbxIdx.c[fn];\r\n                    let win = (nwt.win !== null && nwt.win.length > 10) ? 'wins' : 'win';\r\n                    return (\r\n                        <div style={{ float: \"left\", width: \"15%\", minWidth: 150, minHeight: 100, margin: 5 }} key={fn}>\r\n                            <div>{nwt.name}</div>\r\n                            <Link to={`/${fn}`}>{fn}</Link> <br />\r\n                            <Link to={`/${fn}/cmn+CMN_MWM_03`}>Bob</Link> <Link to={`/${fn}/cmn+CMN_MWM_01`}>Walk</Link> <Link to={`/${fn}/cmn+CMN_MWM_02`}>Run</Link> {nwt.win !== null && <Link to={`/${fn}/${win}+${nwt.win}`}>Win</Link>} <br />\r\n                            Faces: {faces.map(fi => <React.Fragment key={fi}><Link to={`/${fn}/-/face${fi}`}>{fi}</Link> </React.Fragment>)} <br />\r\n                            <Link to={`/${fn}/-/-/w`}>wireframe</Link> <Link to={`/${fn}/-/-/px8`}>pixelate</Link>\r\n                        </div>)\r\n                })\r\n            }\r\n        </div >\r\n    )\r\n}\r\n\r\nexport function DragonIndex() {\r\n    return (\r\n        <div>\r\n            {\r\n                Object.keys(fbxIdx.d).map(fn => {\r\n                    let name = fbxIdx.d[fn].name;\r\n                    return (\r\n                        <div style={{ float: \"left\", width: \"15%\", minWidth: 150, minHeight: 60, margin: 5 }} key={fn}>\r\n                            <div>{name}</div>\r\n                            <Link to={`/${fn}`}>{fn}</Link> <br />\r\n                            <Link to={`/${fn}/-/-/w`}>wireframe</Link> <Link to={`/${fn}/-/-/px8`}>pixelate</Link>\r\n                        </div>)\r\n                })\r\n            }\r\n        </div >\r\n    )\r\n}\r\n\r\nexport function WeaponIndex() {\r\n    return (\r\n        <div>\r\n            {\r\n                Object.keys(fbxIdx.w).map(fn => {\r\n                    const type = fbxIdx.w[fn].wt;\r\n                    const name = fbxIdx.w[fn].name;\r\n                    const ex = fbxIdx.w[fn].ex;\r\n                    return (\r\n                        <div style={{ float: \"left\", width: \"15%\", minWidth: 150, minHeight: 60, margin: 5 }} key={fn}>\r\n                            <div>{type}<br />{name}</div>\r\n                            <Link to={`/${fn}`}>{fn}</Link> {ex && <Link to={`/${ex}`}>EX</Link>} <br />\r\n                            <Link to={`/${fn}/-/-/w`}>wireframe</Link> <Link to={`/${fn}/-/-/px8`}>pixelate</Link>\r\n                        </div>)\r\n                })\r\n            }\r\n        </div >\r\n    )\r\n}\r\n\r\nexport function OtherIndex() {\r\n    return (\r\n        <div>\r\n            {\r\n                fbxIdx.other.map(fn => {\r\n                    return (\r\n                        <div style={{ float: \"left\", textAlign: \"center\", width: 90, height: 30 }} key={fn}>\r\n                            <Link to={`/${fn}`}>{fn}</Link>\r\n                        </div>)\r\n                })\r\n            }\r\n        </div >\r\n    )\r\n}","import React from 'react';\r\nimport { HashRouter, Switch, Route, Link } from 'react-router-dom';\r\nimport Model from './Model';\r\n// import { CharacterIndex, DragonIndex } from './Gallery';\r\nimport { CharacterIndex, DragonIndex, WeaponIndex, OtherIndex } from './Gallery';\r\nexport const fbxSource = process.env.PUBLIC_URL;\r\n\r\nclass App extends React.Component {\r\n  render() {\r\n    return (\r\n      <HashRouter basename=\"/\">\r\n        <Switch>\r\n          <Route exact path=\"/\">\r\n            <ul>\r\n              <li><Link to={`/character`}>character</Link></li>\r\n              <li><Link to={`/dragon`}>dragon</Link></li>\r\n              <li><Link to={`/weapon`}>weapon</Link></li>\r\n              <li><Link to={`/other`}>other</Link></li>\r\n            </ul>\r\n          </Route>\r\n          <Route exact path=\"/character\" component={CharacterIndex} />\r\n          <Route exact path=\"/dragon\" component={DragonIndex} />\r\n          <Route exact path=\"/weapon\" component={WeaponIndex} />\r\n          <Route exact path=\"/other\" component={OtherIndex} />\r\n          <Route path=\"/:asset/:animationIdx?/:face?/:renderMode?/:rotation?/:cameraPosition?/:controlsPosition?\" component={Model} />\r\n        </Switch>\r\n      </HashRouter>)\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.register();\r\n"],"sourceRoot":""}